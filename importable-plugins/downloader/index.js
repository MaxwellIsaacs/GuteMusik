(()=>{var{React:i,useState:c,useEffect:q,useCallback:E,useRef:be,invoke:x,listen:L}=window.GuteMusik,fe=({src:n,alt:k,className:b})=>{let[f,y]=c(!1),[v,S]=c(!1),$=be(null);return q(()=>{let N=new IntersectionObserver(([_])=>{_.isIntersecting&&(y(!0),N.disconnect())},{rootMargin:"100px"});return $.current&&N.observe($.current),()=>N.disconnect()},[]),i.createElement("div",{ref:$,className:b},f&&!v&&i.createElement("img",{src:n,alt:k,className:"w-full h-full object-cover",onError:()=>S(!0),loading:"lazy"}))},ye=({onToast:n,onAllComplete:k})=>{let[b,f]=c([]),[y,v]=c(!1);q(()=>{let r=async()=>{try{let o=await x("downloader_get_status");v(o.is_active),o.albums.length>0?f(d=>{let u=[...o.albums];for(let m=0;m<u.length;m++)d[m]&&(u[m].currentTrack=d[m].currentTrack,u[m].currentTrackStatus=d[m].currentTrackStatus);return u}):f([])}catch{}};r();let l=setInterval(r,2e3);return()=>clearInterval(l)},[]),q(()=>{let r=[];return L("download-progress",l=>{let o=l.payload;f(d=>{let u=[...d];return u[o.album_index]&&(u[o.album_index]={...u[o.album_index],completed_tracks:o.status==="done"?o.track_index+1:u[o.album_index].completed_tracks,total_tracks:o.total_tracks,currentTrack:o.track_name,currentTrackStatus:o.status}),u})}).then(l=>r.push(l)),L("download-album-complete",l=>{let{artist:o,album:d}=l.payload;n(`Finished: ${o} - ${d}`)}).then(l=>r.push(l)),L("download-all-complete",()=>{v(!1),n("All downloads complete!"),k()}).then(l=>r.push(l)),L("download-cancelled",()=>{v(!1),n("Downloads cancelled")}).then(l=>r.push(l)),L("download-error",l=>{let{artist:o,album:d,error:u}=l.payload;n(`Error: ${o} - ${d}: ${u}`)}).then(l=>r.push(l)),()=>{r.forEach(l=>l())}},[n,k]);let S=async()=>{try{await x("downloader_cancel")}catch(r){n(`Cancel failed: ${r}`)}},$=E(async()=>{try{await x("downloader_clear_finished"),f(r=>r.filter(l=>l.status!=="complete"&&l.status!=="error"&&l.status!=="cancelled"))}catch(r){n(`Clear failed: ${r}`)}},[n]);if(b.length===0)return null;let N=b.some(r=>r.status==="complete"||r.status==="error"||r.status==="cancelled"),_=b.filter(r=>r.status==="pending"||r.status==="downloading").length,D=r=>{switch(r){case"searching":return"Searching YouTube...";case"downloading":return"Downloading...";case"tagging":return"Tagging...";case"done":return"Done";case"complete":return"Complete";case"error":return"Error";case"cancelled":return"Cancelled";case"pending":return"Waiting...";case"fetching_cover":return"Fetching cover art...";case"fetching_tracklist":return"Fetching tracklist...";default:return r}},P=r=>{switch(r){case"complete":return"text-emerald-400";case"error":return"text-red-400";case"cancelled":return"text-orange-400";case"downloading":return"text-blue-400";default:return"text-white/50"}},w=r=>{switch(r){case"complete":return"bg-emerald-400";case"error":return"bg-red-400";case"cancelled":return"bg-orange-400";case"downloading":return"bg-blue-400 animate-pulse";case"pending":return"bg-white/20";default:return"bg-white/20"}};return i.createElement("div",{className:"space-y-3"},i.createElement("div",{className:"flex items-center justify-between mb-4"},i.createElement("h3",{className:"text-xs font-bold tracking-[0.2em] text-white/40 uppercase"},"Download Queue",_>0&&i.createElement("span",{className:"ml-2 text-white/60"},`${_} active`)),i.createElement("div",{className:"flex items-center gap-3"},N&&i.createElement("button",{onClick:$,className:"text-xs text-white/30 hover:text-white/60 transition-colors font-medium tracking-wide"},"Clear Done"),y&&i.createElement("button",{onClick:S,className:"text-xs text-red-400/70 hover:text-red-400 transition-colors font-medium tracking-wide"},"Cancel All"))),...b.map((r,l)=>{let o=r.total_tracks>0?r.completed_tracks/r.total_tracks*100:0,d=r.status==="complete"||r.status==="error"||r.status==="cancelled";return i.createElement("div",{key:`${r.artist}-${r.album}-${l}`,className:`bg-white/[0.03] border border-white/5 rounded-2xl p-5 space-y-3 transition-opacity ${d?"opacity-50":""}`},i.createElement("div",{className:"flex items-start justify-between gap-4"},i.createElement("div",{className:"min-w-0"},i.createElement("div",{className:"text-sm font-semibold truncate"},r.album),i.createElement("div",{className:"text-xs text-white/40 truncate"},r.artist)),i.createElement("div",{className:"flex items-center gap-2 flex-shrink-0"},i.createElement("div",{className:`w-2 h-2 rounded-full ${w(r.status)}`}),i.createElement("span",{className:`text-xs font-medium capitalize ${P(r.status)}`},D(r.status)))),r.total_tracks>0&&r.status!=="complete"&&i.createElement("div",{className:"space-y-2"},i.createElement("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden"},i.createElement("div",{className:"h-full bg-gradient-to-r from-purple-500 to-blue-500 rounded-full transition-all duration-500 ease-out",style:{width:`${o}%`}})),i.createElement("div",{className:"flex items-center justify-between text-[10px] text-white/30 font-mono"},i.createElement("span",null,`${r.completed_tracks}/${r.total_tracks} tracks`),i.createElement("span",null,`${Math.round(o)}%`))),r.currentTrack&&r.status==="downloading"&&i.createElement("div",{className:"text-[11px] text-white/30 truncate"},i.createElement("span",{className:"text-white/50"},D(r.currentTrackStatus||""))," ",r.currentTrack),r.error&&i.createElement("div",{className:"text-[11px] text-red-400/70 truncate"},r.error))}))},ve=({onToast:n,serverState:k,refreshAlbums:b,refreshArtists:f})=>{let[y,v]=c("search"),[S,$]=c(""),[N,_]=c(!1),[D,P]=c([]),[w,r]=c(null),[l,o]=c(!1),[d,u]=c([]),[m,A]=c(new Set),[U,te]=c(""),[R,ae]=c("all"),[V,se]=c(!0),[C,Y]=c([{artist:"",album:"",year:"",genre:""}]),[z,re]=c(""),[Q,B]=c(!1),[H,K]=c([]),[p,I]=c([]),[G,ne]=c(""),[Ne,M]=c(!1),W=E(async()=>{let e=S.trim();if(e){_(!0),P([]),r(null),u([]),A(new Set);try{let a=await x("downloader_search_artist",{artist:e});P(a),(a.length===1||a.length>0&&a[0].name.toLowerCase()===e.toLowerCase())&&J(a[0])}catch(a){n(`Search failed: ${a}`)}finally{_(!1)}}},[S,n]),J=E(async e=>{r(e),o(!0),u([]),A(new Set);try{let a=await x("downloader_get_discography",{artistId:e.id});u(a)}catch(a){n(`Failed to load discography: ${a}`)}finally{o(!1)}},[n]),j=d.filter(e=>V&&e.secondary_types.some(a=>["Compilation","Live","Soundtrack","Remix","DJ-mix","Mixtape/Street","Demo","Interview","Spokenword"].includes(a))&&(R!=="all"||!e.secondary_types.includes("Mixtape/Street"))?!1:R==="all"?!0:R==="album"?e.type==="Album":R==="ep"?e.type==="EP":R==="single"?e.type==="Single":R==="other"?!["Album","EP","Single"].includes(e.type):!0),le=e=>{A(a=>{let s=new Set(a);return s.has(e)?s.delete(e):s.add(e),s})},ie=()=>{let e=j.map(a=>a.id);e.every(a=>m.has(a))?A(a=>{let s=new Set(a);return e.forEach(h=>s.delete(h)),s}):A(a=>{let s=new Set(a);return e.forEach(h=>s.add(h)),s})},oe=E(async()=>{if(!w)return;let e=d.filter(s=>m.has(s.id));if(e.length===0){n("No albums selected");return}let a=e.map(s=>({artist:w.name,album:s.title,year:s.year,genre:U||"Rock",tracks:null}));try{await x("downloader_start",{albums:a}),n(`Queued ${a.length} album${a.length>1?"s":""} for download`),A(new Set),M(!0),setTimeout(()=>M(!1),2e3)}catch(s){n(`Download failed: ${s}`)}},[d,m,w,U,n]),X=E(async()=>{let e=z.trim();if(e){B(!0),K([]);try{let a=await x("downloader_search_songs",{query:e});K(a)}catch(a){n(`Song search failed: ${a}`)}finally{B(!1)}}},[z,n]),ce=e=>{let a="",s=e.title,h=[" - "," \u2014 "," | "];for(let g of h)if(e.title.includes(g)){let T=e.title.split(g);a=T[0].trim(),s=T.slice(1).join(g).trim();break}s=s.replace(/\s*[\(\[].*?(official|video|audio|lyrics|hd|4k|visualizer|music video).*?[\)\]]\s*/gi,"").replace(/\s*[\(\[].*?[\)\]]\s*$/,"").trim(),I(g=>g.some(T=>T.ytResult.id===e.id)?g:[...g,{ytResult:e,artist:a,album:"",title:s,year:new Date().getFullYear().toString(),genre:G||"Rock"}])},de=e=>{I(a=>a.filter(s=>s.ytResult.id!==e))},F=(e,a,s)=>{I(h=>h.map(g=>g.ytResult.id===e?{...g,[a]:s}:g))},ue=E(async()=>{if(p.length===0){n("No songs added for download");return}let e=p.map(s=>({title:s.title,artist:s.artist||"Unknown Artist",album:s.album,year:s.year,genre:s.genre||G||"Rock",track_num:null})),a=p.map(s=>s.ytResult.id);try{await x("downloader_download_songs",{songs:e,videoIds:a}),n(`Queued ${e.length} song${e.length>1?"s":""} for download`),I([]),M(!0),setTimeout(()=>M(!1),2e3)}catch(s){n(`Download failed: ${s}`)}},[p,G,n]),me=E(async()=>{let e=C.filter(s=>s.artist.trim()&&s.album.trim());if(e.length===0){n("Fill in at least one album");return}let a=e.map(s=>({artist:s.artist.trim(),album:s.album.trim(),year:s.year.trim(),genre:s.genre.trim()||"Rock",tracks:null}));try{await x("downloader_start",{albums:a}),n(`Queued ${a.length} album${a.length>1?"s":""} for download`),Y([{artist:"",album:"",year:"",genre:""}]),M(!0),setTimeout(()=>M(!1),2e3)}catch(s){n(`Download failed: ${s}`)}},[C,n]),he=E(async()=>{if(k.isConnected&&k.serverUrl)try{let e=localStorage.getItem("lumina-server-config");if(e){let{url:a,username:s,password:h}=JSON.parse(e);await x("downloader_trigger_scan",{serverUrl:a,username:s,password:h}),n("Navidrome rescan triggered"),setTimeout(()=>{b(),f()},3e3)}}catch(e){n(`Rescan failed: ${e}`)}},[k,n,b,f]),O=(e,a,s)=>{Y(h=>{let g=[...h];return g[e]={...g[e],[a]:s},g})},ge=()=>{Y(e=>[...e,{artist:"",album:"",year:"",genre:""}])},pe=e=>{C.length<=1||Y(a=>a.filter((s,h)=>h!==e))},we=e=>`https://coverartarchive.org/release-group/${e}/front-250`,Z=e=>!e||e==="Album"?"":e,ee=d.reduce((e,a)=>{if(V&&a.secondary_types.some(h=>["Compilation","Live","Soundtrack","Remix","DJ-mix","Mixtape/Street","Demo","Interview","Spokenword"].includes(h)))return e;let s=["Album","EP","Single"].includes(a.type)?a.type.toLowerCase():"other";return e[s]=(e[s]||0)+1,e},{}),xe=Object.values(ee).reduce((e,a)=>e+a,0),t=i.createElement;return t("div",{className:"pb-32"},t("div",{className:"mb-10"},t("h2",{className:"text-sm font-bold tracking-[0.2em] text-white/40 uppercase mb-2"},"Plugin"),t("h1",{className:"text-4xl font-bold tracking-tight"},"Downloader"),t("p",{className:"text-sm text-white/30 mt-2"},"Download albums by artist, individual songs, or enter manually. Auto-tagged with MusicBrainz metadata.")),t("div",{className:"flex gap-1 bg-white/5 rounded-xl p-1 w-fit mb-8 border border-white/5"},t("button",{onClick:()=>v("search"),className:`px-5 py-2 rounded-lg text-sm font-medium transition-colors ${y==="search"?"bg-white/10 text-white":"text-white/40 hover:text-white/70"}`},"Albums"),t("button",{onClick:()=>v("songs"),className:`px-5 py-2 rounded-lg text-sm font-medium transition-colors ${y==="songs"?"bg-white/10 text-white":"text-white/40 hover:text-white/70"}`},"Songs"),t("button",{onClick:()=>v("manual"),className:`px-5 py-2 rounded-lg text-sm font-medium transition-colors ${y==="manual"?"bg-white/10 text-white":"text-white/40 hover:text-white/70"}`},"Manual")),t("div",{className:"flex gap-8 flex-col lg:flex-row"},t("div",{className:"flex-1 min-w-0"},y==="search"?t("div",{className:"space-y-6"},t("div",{className:"flex gap-3"},t("input",{type:"text",placeholder:"Artist name...",value:S,onChange:e=>$(e.target.value),onKeyDown:e=>e.key==="Enter"&&W(),className:"flex-1 bg-white/5 border border-white/5 rounded-xl px-5 py-3 text-sm text-white placeholder:text-white/20 focus:outline-none focus:bg-white/10 focus:border-white/20 transition-colors"}),t("button",{onClick:W,disabled:N||!S.trim(),className:"px-6 py-3 bg-white/10 border border-white/5 rounded-xl text-sm font-semibold hover:bg-white/20 disabled:opacity-30 disabled:hover:bg-white/10 transition-colors"},N?t("span",{className:"flex items-center gap-2"},t("span",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Searching"):"Search")),D.length>1&&!w&&t("div",{className:"space-y-2"},t("h3",{className:"text-xs font-bold tracking-[0.2em] text-white/40 uppercase"},"Pick the right artist"),t("div",{className:"space-y-1"},...D.map(e=>t("button",{key:e.id,onClick:()=>J(e),className:"w-full flex items-center gap-3 p-3 rounded-xl bg-white/[0.02] border border-white/5 hover:bg-white/5 text-left transition-colors"},t("span",{className:"text-sm font-semibold"},e.name),e.disambiguation&&t("span",{className:"text-xs text-white/30"},e.disambiguation))))),l&&t("div",{className:"flex items-center gap-3 py-12 justify-center text-white/30 text-sm"},t("span",{className:"w-4 h-4 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"}),`Loading discography for ${w?.name}...`),w&&!l&&d.length>0&&t("div",{className:"space-y-4"},t("div",{className:"flex items-center justify-between"},t("div",{className:"flex items-center gap-3"},t("button",{onClick:()=>{r(null),u([]),A(new Set)},className:"text-xs text-white/30 hover:text-white transition-colors"},"\u2190 Back"),t("h3",{className:"text-lg font-bold"},w.name),t("span",{className:"text-xs text-white/30"},`${d.length} releases`)),t("button",{onClick:ie,className:"text-xs text-white/40 hover:text-white transition-colors font-medium"},j.every(e=>m.has(e.id))&&j.length>0?"Deselect All":"Select All")),t("div",{className:"flex items-center gap-3 flex-wrap"},t("div",{className:"flex gap-1 bg-white/5 rounded-lg p-1 border border-white/5"},...["all","album","ep","single","other"].map(e=>{let a=e==="all"?xe:ee[e]||0;return t("button",{key:e,onClick:()=>ae(e),className:`px-3 py-1 rounded-md text-xs font-medium transition-colors ${R===e?"bg-white/10 text-white":"text-white/30 hover:text-white/60"}`},`${e==="all"?"All":e.toUpperCase()}${a>0?` (${a})`:""}`)})),t("label",{className:"flex items-center gap-2 text-xs text-white/30 cursor-pointer select-none"},t("input",{type:"checkbox",checked:V,onChange:e=>se(e.target.checked),className:"accent-purple-500"}),"Hide compilations/live/soundtracks"),t("div",{className:"flex items-center gap-2 ml-auto"},t("span",{className:"text-xs text-white/30 font-medium uppercase tracking-widest"},"Genre"),t("input",{type:"text",placeholder:"Rock",value:U,onChange:e=>te(e.target.value),className:"bg-white/5 border border-white/5 rounded-lg px-3 py-1.5 text-xs text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors w-32"}))),t("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3"},...j.map(e=>{let a=m.has(e.id);return t("button",{key:e.id,onClick:()=>le(e.id),className:`flex items-center gap-4 p-3 rounded-xl border text-left transition-all ${a?"bg-white/10 border-purple-500/40 shadow-[0_0_20px_rgba(168,85,247,0.05)]":"bg-white/[0.02] border-white/5 hover:bg-white/5"}`},t(fe,{src:we(e.id),alt:"",className:"w-14 h-14 rounded-lg bg-white/5 flex-shrink-0 overflow-hidden"}),t("div",{className:"min-w-0 flex-1"},t("div",{className:"text-sm font-semibold truncate"},e.title),t("div",{className:"text-xs text-white/30 flex items-center gap-2 mt-0.5"},e.year&&t("span",null,e.year),Z(e.type)&&t("span",{className:"px-1.5 py-0.5 bg-white/5 rounded text-[10px] uppercase tracking-wider"},Z(e.type)),e.secondary_types.length>0&&t("span",{className:"text-[10px] text-white/20"},e.secondary_types.join(", ")))),t("div",{className:`w-5 h-5 rounded-md border-2 flex-shrink-0 flex items-center justify-center transition-colors ${a?"bg-purple-500 border-purple-500":"border-white/20"}`},a&&t("svg",{width:12,height:12,viewBox:"0 0 12 12",fill:"none"},t("path",{d:"M2.5 6L5 8.5L9.5 3.5",stroke:"white",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}))))})),j.length===0&&t("div",{className:"text-center py-8 text-white/20 text-sm"},"No releases match the current filters"),m.size>0&&t("div",{className:"pt-4"},t("button",{onClick:oe,className:"w-full py-4 bg-white text-black rounded-xl font-bold text-sm hover:bg-white/90 transition-all"},`Download ${m.size} Album${m.size>1?"s":""}`))),!N&&!l&&d.length===0&&!w&&D.length===0&&t("div",{className:"text-center py-16 text-white/20 text-sm"},"Search for an artist to browse their discography")):y==="songs"?t("div",{className:"space-y-6"},t("div",{className:"flex gap-3"},t("input",{type:"text",placeholder:"Search for a song...",value:z,onChange:e=>re(e.target.value),onKeyDown:e=>e.key==="Enter"&&X(),className:"flex-1 bg-white/5 border border-white/5 rounded-xl px-5 py-3 text-sm text-white placeholder:text-white/20 focus:outline-none focus:bg-white/10 focus:border-white/20 transition-colors"}),t("button",{onClick:X,disabled:Q||!z.trim(),className:"px-6 py-3 bg-white/10 border border-white/5 rounded-xl text-sm font-semibold hover:bg-white/20 disabled:opacity-30 disabled:hover:bg-white/10 transition-colors"},Q?t("span",{className:"flex items-center gap-2"},t("span",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Searching"):"Search")),t("div",{className:"flex items-center gap-3"},t("span",{className:"text-xs text-white/30 font-medium uppercase tracking-widest"},"Default Genre"),t("input",{type:"text",placeholder:"Rock",value:G,onChange:e=>ne(e.target.value),className:"bg-white/5 border border-white/5 rounded-lg px-3 py-1.5 text-xs text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors w-32"})),H.length>0&&t("div",{className:"space-y-3"},t("h3",{className:"text-xs font-bold tracking-[0.2em] text-white/40 uppercase"},"Search Results"),t("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-2"},...H.map(e=>{let a=p.some(s=>s.ytResult.id===e.id);return t("button",{key:e.id,onClick:()=>!a&&ce(e),disabled:a,className:`w-full flex items-center gap-4 p-3 rounded-xl border text-left transition-all ${a?"bg-white/5 border-purple-500/30 opacity-50":"bg-white/[0.02] border-white/5 hover:bg-white/5"}`},t("div",{className:"w-10 h-10 rounded-lg bg-white/5 flex-shrink-0 overflow-hidden"},t("img",{src:`https://i.ytimg.com/vi/${e.id}/default.jpg`,alt:"",className:"w-full h-full object-cover",loading:"lazy"})),t("div",{className:"min-w-0 flex-1"},t("div",{className:"text-sm font-medium truncate"},e.title),t("div",{className:"text-xs text-white/30 flex items-center gap-2"},t("span",null,e.channel),t("span",{className:"text-white/20"},"\u2022"),t("span",null,e.duration))),t("div",{className:`px-3 py-1 rounded-lg text-xs font-medium ${a?"bg-purple-500/20 text-purple-300":"bg-white/5 text-white/50 hover:bg-white/10 hover:text-white"}`},a?"Added":"+ Add"))}))),p.length>0&&t("div",{className:"space-y-3"},t("div",{className:"flex items-center justify-between"},t("h3",{className:"text-xs font-bold tracking-[0.2em] text-white/40 uppercase"},`Download List (${p.length})`),t("button",{onClick:()=>I([]),className:"text-xs text-white/30 hover:text-red-400 transition-colors"},"Clear All")),t("div",{className:"space-y-3"},...p.map(e=>t("div",{key:e.ytResult.id,className:"bg-white/[0.03] border border-white/5 rounded-2xl p-4 space-y-3"},t("div",{className:"flex items-center justify-between gap-3"},t("div",{className:"flex items-center gap-3 min-w-0 flex-1"},t("div",{className:"w-10 h-10 rounded-lg bg-white/5 flex-shrink-0 overflow-hidden"},t("img",{src:`https://i.ytimg.com/vi/${e.ytResult.id}/default.jpg`,alt:"",className:"w-full h-full object-cover"})),t("div",{className:"min-w-0"},t("div",{className:"text-xs text-white/30 truncate"},e.ytResult.title),t("div",{className:"text-[10px] text-white/20"},e.ytResult.duration))),t("button",{onClick:()=>de(e.ytResult.id),className:"text-xs text-white/20 hover:text-red-400 transition-colors"},"Remove")),t("div",{className:"grid grid-cols-2 gap-2"},t("input",{type:"text",placeholder:"Title",value:e.title,onChange:a=>F(e.ytResult.id,"title",a.target.value),className:"bg-white/5 border border-white/5 rounded-lg px-3 py-2 text-sm text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors"}),t("input",{type:"text",placeholder:"Artist",value:e.artist,onChange:a=>F(e.ytResult.id,"artist",a.target.value),className:"bg-white/5 border border-white/5 rounded-lg px-3 py-2 text-sm text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors"}),t("input",{type:"text",placeholder:"Album (optional)",value:e.album,onChange:a=>F(e.ytResult.id,"album",a.target.value),className:"bg-white/5 border border-white/5 rounded-lg px-3 py-2 text-sm text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors"}),t("div",{className:"flex gap-2"},t("input",{type:"text",placeholder:"Year",value:e.year,onChange:a=>F(e.ytResult.id,"year",a.target.value),className:"flex-1 bg-white/5 border border-white/5 rounded-lg px-3 py-2 text-sm text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors"}),t("input",{type:"text",placeholder:"Genre",value:e.genre,onChange:a=>F(e.ytResult.id,"genre",a.target.value),className:"flex-1 bg-white/5 border border-white/5 rounded-lg px-3 py-2 text-sm text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors"})))))),t("div",{className:"pt-2"},t("button",{onClick:ue,className:"w-full py-4 bg-white text-black rounded-xl font-bold text-sm hover:bg-white/90 transition-all"},`Download ${p.length} Song${p.length>1?"s":""}`))),p.length>0&&t("div",{className:"text-xs text-white/20 text-center"},'Tip: Songs without an album will be saved to a "Singles" folder for the artist.'),!Q&&H.length===0&&p.length===0&&t("div",{className:"text-center py-16 text-white/20 text-sm space-y-2"},t("div",null,"Search for any song on YouTube to download it"),t("div",{className:"text-xs text-white/10"},"Results are auto-parsed for artist/title, but you can edit before downloading"))):t("div",{className:"space-y-4"},...C.map((e,a)=>t("div",{key:a,className:"bg-white/[0.03] border border-white/5 rounded-2xl p-5 space-y-3"},t("div",{className:"flex items-center justify-between mb-1"},t("span",{className:"text-xs text-white/20 font-mono"},`#${a+1}`),C.length>1&&t("button",{onClick:()=>pe(a),className:"text-xs text-white/20 hover:text-red-400 transition-colors"},"Remove")),t("div",{className:"grid grid-cols-2 gap-3"},t("input",{type:"text",placeholder:"Artist",value:e.artist,onChange:s=>O(a,"artist",s.target.value),className:"bg-white/5 border border-white/5 rounded-lg px-3 py-2.5 text-sm text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors"}),t("input",{type:"text",placeholder:"Album",value:e.album,onChange:s=>O(a,"album",s.target.value),className:"bg-white/5 border border-white/5 rounded-lg px-3 py-2.5 text-sm text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors"}),t("input",{type:"text",placeholder:"Year",value:e.year,onChange:s=>O(a,"year",s.target.value),className:"bg-white/5 border border-white/5 rounded-lg px-3 py-2.5 text-sm text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors"}),t("input",{type:"text",placeholder:"Genre (default: Rock)",value:e.genre,onChange:s=>O(a,"genre",s.target.value),className:"bg-white/5 border border-white/5 rounded-lg px-3 py-2.5 text-sm text-white placeholder:text-white/20 focus:outline-none focus:border-white/20 transition-colors"})))),t("button",{onClick:ge,className:"w-full py-3 border border-dashed border-white/10 rounded-xl text-xs text-white/30 hover:text-white/60 hover:border-white/20 transition-colors font-medium uppercase tracking-widest"},"+ Add Another Album"),t("div",{className:"pt-2"},t("button",{onClick:me,disabled:!C.some(e=>e.artist.trim()&&e.album.trim()),className:"w-full py-4 bg-white text-black rounded-xl font-bold text-sm hover:bg-white/90 disabled:opacity-30 transition-all"},`Download ${C.filter(e=>e.artist.trim()&&e.album.trim()).length} Album${C.filter(e=>e.artist.trim()&&e.album.trim()).length!==1?"s":""}`)))),t("div",{className:"lg:w-80 flex-shrink-0"},t(ye,{onToast:n,onAllComplete:he}))))};window.GuteMusik.registerPlugin({id:"downloader",label:"Downloader",icon:"download",view:ve});})();
